<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="css/_reset.css">
        <link rel="stylesheet" href="css/_root.css">
        <link rel="stylesheet" href="css/main.css">
    </head>
    <body>
        <script src="./lib/jquery-3.7.1.min.js"></script>
        <script src="./lib/marked.min.js"></script>

        <!-- <script src="./api/Document.js"></script>
        <script src="./api/Context.js"></script>
        <script src="./api/Plugin.js"></script>

        <script src="./js/GlobalProfiler.js"></script>
        <script src="./js/Executor.js"></script>

        <script>
            const API = {
                Document: __Document,
                Context: __Context,
                Plugin: __Plugin
            }
        </script>

        <script src="./js/APIProfiler.js"></script> -->

        <div class="header">
            <div class="logo">
                <p class="logo-cristall-app">Cristall.<span class="logo-red-app">app</span></p>
            </div>
            <div class="breadcrumbs" style="display: none;">
                <div class="sidebar-workspace-changer">
                    <div class="sidebar-workspace-switcher">
                        <button class="sidebar-workspace-button">
                            <div class="left-arrow-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
                                    <path d="M11.25 14.9401L6.36 10.0501C5.7825 9.47256 5.7825 8.52756 6.36 7.95006L11.25 3.06006" stroke="#999999" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </button>
                        <p class="sidebar-workspace-title" id="workspace-name">Workspace</p>
                        <button class="sidebar-workspace-button">
                            <div class="right-arrow-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
                                    <path d="M6.6825 14.9401L11.5725 10.0501C12.15 9.47256 12.15 8.52756 11.5725 7.95006L6.6825 3.06006" stroke="#999999" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
            <div class="control-island-frame">
                <button class="control-island-button">
                    <div class="settings-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M10 12.5C11.3807 12.5 12.5 11.3807 12.5 10C12.5 8.61929 11.3807 7.5 10 7.5C8.61929 7.5 7.5 8.61929 7.5 10C7.5 11.3807 8.61929 12.5 10 12.5Z" stroke="#999999" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M1.66669 10.7334V9.26669C1.66669 8.40003 2.37502 7.68336 3.25002 7.68336C4.75835 7.68336 5.37502 6.6167 4.61669 5.30836C4.18335 4.55836 4.44169 3.58336 5.20002 3.15003L6.64169 2.32503C7.30002 1.93336 8.15002 2.1667 8.54169 2.82503L8.63335 2.98336C9.38335 4.2917 10.6167 4.2917 11.375 2.98336L11.4667 2.82503C11.8584 2.1667 12.7084 1.93336 13.3667 2.32503L14.8084 3.15003C15.5667 3.58336 15.825 4.55836 15.3917 5.30836C14.6334 6.6167 15.25 7.68336 16.7584 7.68336C17.625 7.68336 18.3417 8.39169 18.3417 9.26669V10.7334C18.3417 11.6 17.6334 12.3167 16.7584 12.3167C15.25 12.3167 14.6334 13.3834 15.3917 14.6917C15.825 15.45 15.5667 16.4167 14.8084 16.85L13.3667 17.675C12.7084 18.0667 11.8584 17.8334 11.4667 17.175L11.375 17.0167C10.625 15.7084 9.39169 15.7084 8.63335 17.0167L8.54169 17.175C8.15002 17.8334 7.30002 18.0667 6.64169 17.675L5.20002 16.85C4.44169 16.4167 4.18335 15.4417 4.61669 14.6917C5.37502 13.3834 4.75835 12.3167 3.25002 12.3167C2.37502 12.3167 1.66669 11.6 1.66669 10.7334Z" stroke="#999999" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </button>
                <button class="control-island-button" data-channel="app:minimize">
                    <div class="minus-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" fill="none">
                            <path d="M4.5 9H13.5" stroke="#999999" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </button>
                <button class="control-island-button" data-channel="app:maximize">
                    <div class="stop-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <path d="M6.2 14H9.8C12.8 14 14 12.8 14 9.8V6.2C14 3.2 12.8 2 9.8 2H6.2C3.2 2 2 3.2 2 6.2V9.8C2 12.8 3.2 14 6.2 14Z" stroke="#999999" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </button>
                <button class="control-island-button" data-channel="app:close">
                    <div class="add-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="34" height="34" viewBox="0 0 34 34" fill="none">
                            <path d="M12.7573 21.2426L21.2426 12.7574" stroke="#999999" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M21.2426 21.2426L12.7573 12.7574" stroke="#999999" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                </button>
            </div>
        </div>
        <div class="cristall-body">
            <div class="blur" style="display: none"></div>
            <div class="popup-wrapper" style="display: none">
                <div class="popup-frame">
                    <div class="popup-header">
                        <p class="popup-title">Select the file type</p>
                    </div>
                    <div class="popup-body">
                        <div class="popup-body-item">
                            <div class="popup-body-item-icon">
                                <p class="popup-title">MD</p>
                            </div>
                            <div class="popup-body-item-text-frame">
                                <p class="popup-body-item-title">Markdown</p>
                                <p class="popup-body-item-description">Classical Markdown. Content can be ported to other platforms.</p>
                            </div>
                        </div>
                        <div class="popup-body-item">
                            <div class="popup-body-item-icon">
                                <p class="popup-title">MD</p>
                            </div>
                            <div class="popup-body-item-text-frame">
                                <p class="popup-body-item-title">Extended Markdown</p>
                                <p class="popup-body-item-description">Markdown created specifically for Cristal.app. EMD Lib support will be required for porting (not public).</p>
                            </div>
                        </div>
                        <div class="popup-body-item">
                            <div class="popup-body-item-icon">
                                <p class="popup-title">MD</p>
                            </div>
                            <div class="popup-body-item-text-frame">
                                <p class="popup-body-item-title">JSON</p>
                                <p class="popup-body-item-description">A file for creating configurations and more.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="notifications">
                <!-- <div class="notification">
                    <h3 class="notification-title">Notification</h3>
                    <p class="notification-text">Yes, it's notification. What's up?</p>
                </div> -->
            </div>

            <div class="sidebar">
                <div class="sidebar-panel">
                    <div class="sidebar-controls">
                        <button class="sidebar-button" id="file">
                            <div class="file-add-icon">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M18.3333 8.33329V12.5C18.3333 16.6666 16.6667 18.3333 12.5 18.3333H7.49999C3.33332 18.3333 1.66666 16.6666 1.66666 12.5V7.49996C1.66666 3.33329 3.33332 1.66663 7.49999 1.66663H11.6667" stroke="#999999" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M18.3333 8.33329H15C12.5 8.33329 11.6667 7.49996 11.6667 4.99996V1.66663L18.3333 8.33329Z" stroke="#999999" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>                                    
                            </div>
                        </button>
                        <button class="sidebar-button">
                            <div class="folder-add-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M10.05 13.75V9.58334" stroke="#999999" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M12.0833 11.6667H7.91666" stroke="#999999" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M18.3333 9.16666V14.1667C18.3333 17.5 17.5 18.3333 14.1667 18.3333H5.83332C2.49999 18.3333 1.66666 17.5 1.66666 14.1667V5.83332C1.66666 2.49999 2.49999 1.66666 5.83332 1.66666H7.08332C8.33332 1.66666 8.60832 2.03332 9.08332 2.66666L10.3333 4.33332C10.65 4.74999 10.8333 4.99999 11.6667 4.99999H14.1667C17.5 4.99999 18.3333 5.83332 18.3333 9.16666Z" stroke="#999999" stroke-width="1.5" stroke-miterlimit="10"/>
                                </svg>
                            </div>
                        </button>
                        <button class="sidebar-button">
                            <div class="workspace-icon">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M13.3334 10.75V14.25C13.3334 17.1666 12.1667 18.3333 9.25002 18.3333H5.75002C2.83335 18.3333 1.66669 17.1666 1.66669 14.25V10.75C1.66669 7.83329 2.83335 6.66663 5.75002 6.66663H9.25002C12.1667 6.66663 13.3334 7.83329 13.3334 10.75Z" stroke="#999999" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M18.3334 5.74996V9.24996C18.3334 12.1666 17.1667 13.3333 14.25 13.3333H13.3334V10.75C13.3334 7.83329 12.1667 6.66663 9.25002 6.66663H6.66669V5.74996C6.66669 2.83329 7.83335 1.66663 10.75 1.66663H14.25C17.1667 1.66663 18.3334 2.83329 18.3334 5.74996Z" stroke="#999999" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>                                    
                            </div>
                        </button>
                    </div>
                    <div class="sidebar-list-files">

                    </div>
                </div>
            </div>
            <div class="viewport">
            </div>
        </div>

        <div data-sector-id="plugins"></div>

        <script src="./js/web.notifications/Notifications.js"></script>
        <!-- <script src="./js/web.plugin/Plugin.js"></script> -->
        <script src="./js/WebLoger.js"></script>
        <!-- <script src="./js/IDGenerator.js"></script>
        <script src="./js/PluginScriptLoader.js"></script>
        <script src="./js/PluginHtmlLoader.js"></script>
        <script src="./js/PluginCSSLoader.js"></script>
        <script src="./js/PluginLoader.js"></script> -->
        <script src="./js/web.loader/Loader.js"></script>
        <script src="./js/web.workspaces/Workspaces.js"></script>

        <!-- FRONTEND-JS -->
        <script>
            let loader = new Loader();
            let workspaces = new Workspaces();

            workspaces.LoadWorkspace().then(() => {
                if (workspaces.DropActiveWorkspace() !== null) {
                    document.querySelector('.breadcrumbs').style = '';
                }
            });

            loader.SetRootElement(document.querySelector('.sidebar-list-files'));

            loader.LoadWebFiles().then(() => {
                loader.ParseAllFiles();
                loader.ImplementFiles();
            });

            // let pluginLoader = new PluginLoader();
            // let scriptLoader = new ScriptLoader();

            // pluginLoader.SetScriptLoaderLink(scriptLoader);

            // pluginLoader.LoadPlugins().then(() => {
            //     pluginLoader.ParseAndApplyPlugins();

            //     TakeNote("{WEB}.PluginLoader.LoadPlugins(callback).callback()", `SUCCESS: applied ${pluginLoader.plugins.length} plugins.`);
            // });

            document.querySelectorAll('[data-channel]').forEach(element => {
                element.addEventListener('click', event => {
                    let channel = element.getAttribute('data-channel');

                    window.electronAPI.invoke(channel);
                });
            });

            document.querySelector('#file').addEventListener('click', () => {
                if (workspaces.DropActiveWorkspace() === null) {
                    Alert('Error', 'Firstly - create the workspace in settings', 1500)
                }
                else {

                }
            });
        </script>
        <!-- FRONTEND-JS -->
    </body>
</html>